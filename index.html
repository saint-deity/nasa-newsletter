<!DOCTYPE html>

<html lang="en">

    <head>
        <title>DeityCord</title>
        <link rel="stylesheet" href="styles.css">
        
    </head>

    <body>
        <section id="containerDisplay">
            <section id="columnContainerServers">
               
            </section>

            <section id="containerServer">
                <section id="containerList">
                    <section id="containerListHeader">
                        <h2 id="serverName">

                        </h2>
                    </section>

                    <section id="containerListBody">
                        <section id="severBody">
                            <section class="messageBody">
                                <section id="messagesHeader">

                                </section>

                                <nav>
                                    <ul>

                                    </ul>
                                </nav>

                                <section id="messagesFooter">

                                </section>

                                <section id="messageFooter">

                                </section>
                            </section>

                            <section id="messageHeader">

                            </section>
                            
                            <section id="messagesContainer">
                                <section id="inputContainer">
                                    <textarea id="messageInput" placeholder="Message #TextChat"></textarea>
                                </section>
                                
                                <section id="buttonContainer">
                                    <a id="messageSend">
                                        <svg id="messageButton" xmlns="http://www.w3.org/2000/svg" version="1.0" width="50.000000pt" height="50.000000pt" viewBox="0 0 40 40" preserveAspectRatio="xMidYMid meet">
                                            <g id="sendVector"  transform="translate(0.000000,32.000000) scale(0.100000,-0.100000)" style="opacity: 50%; stroke: 0; fill: #fff;">
                                            <path d="M91 200 c9 -24 17 -30 40 -30 16 0 29 -4 29 -10 0 -5 -13 -10 -29 -10 -23 0 -31 -6 -40 -30 -5 -16 -6 -30 -2 -30 18 0 141 61 141 70 0 9 -123 70 -141 70 -4 0 -3 -13 2 -30z"/>
                                            </g>
                                        </svg>
                                    </a>
                                </section>
                            </section>
                        </section>

                        <section id="containerHeader">

                        </section>
                    </section>
                </section> 
            </section>
        </section>


        <script src="/scripts/data.js"> 
            console.log(threadsq);
        </script>

        <script defer>
            window.onload = function() {
                document.getElementById('severBody').onload = function() {
                    setTimeout(3000)
                    document.getElementById('severBody').scroll({ top: document.getElementById('severBody').scrollHeight, behavior: 'smooth' });
                }
            }
        </script>

        <script defer>
            var isInput = false;

            document.getElementById('messageInput').addEventListener('input', function() { if (this.value.length > 0) { isInput = true; } else { isInput = false; } document.getElementById('messageButton').style.opacity = event.target.value.length > 0 ? 1 : 0.3 })
  
            document.getElementById('messageSend').addEventListener('mouseover', function() { if (isInput) { document.getElementById('sendVector').style = 'fill: #949cf7; opacity: 100%; cursor: pointer;'; document.getElementById('buttonContainer').style = 'cursor: pointer;' } })

            document.getElementById('messageSend').addEventListener('mouseout', function() { if (isInput) { document.getElementById('sendVector').style = 'fill: #fff; opacity: 100%;'; document.getElementById('buttonContainer').style = 'cursor: pointer;' } })

            document.getElementById('severBody').scroll({ top: document.getElementById('severBody').scrollHeight, behavior: 'smooth' });
        </script>

        <script>
            var id = window.location.search.slice(1);
            function addMessage(message) {
                var messageHtml =  `
                    <li id="message">
                        <div id="message-head">
                            <h2>${message.name}    <span style="color: #999; font-size: 12px">14/11/2022</span></h2>
                        </div>

                        <div id="message-content">
                            ${message.content}
                        </div>
                    </li>
                `

                msgs.insertAdjacentHTML("beforeend", messageHtml);
            }

            var msgs = document.querySelector("ul");
            for (let message of threadsq) {
                addMessage(message);
            }

            var btn = document.querySelector("#messageSend");

            btn.addEventListener("click", function() {
                if (document.getElementById('messageInput').value.length > 0) {

                    var txt = document.querySelector("#messageInput");

                    var message = {
                        name: "Anon",
                        avatar: "",
                        id: 0,

                        content: txt.value,
                        timestamp: Date.now(),
                    }
                    
                    addMessage(message);

                    txt.value = "";
                    threadsq.push(message);

                    localStorage.setItem("threadsq", JSON.stringify(threadsq));

                    document.getElementById('messageButton').style = 'fill: #949cf7; opacity: 20%';

                    isInput = false;

                    document.getElementById('severBody').scroll({ top: document.getElementById('severBody').scrollHeight, behavior: 'smooth' });
                }
            })  
        </script>
    </body>
</html>
